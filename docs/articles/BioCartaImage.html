<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customize BioCarta Pathway Images • BioCartaImage</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Customize BioCarta Pathway Images">
<meta property="og:description" content="BioCartaImage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioCartaImage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/BioCartaImage.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/BioCartaImage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Customize BioCarta Pathway Images</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 data-toc-skip class="date">2023-09-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/BioCartaImage/blob/HEAD/vignettes/BioCartaImage.Rmd" class="external-link"><code>vignettes/BioCartaImage.Rmd</code></a></small>
      <div class="hidden name"><code>BioCartaImage.Rmd</code></div>

    </div>

    
    
<p>BioCarta is a valuable source of biological pathways which not only provides well manually curated pathways, but also remarkably intuitive pathway images. One useful features of pathway analysis which is to highlight genes of interest on the pathway images has been lost. Since the original source of BioCarta (biocarte.com) is lost from the internet, we digged out the data from the internet archive and formatted it into a package.</p>
<p>The BioCarta data is collected from <a href="https://web.archive.org/web/20170122225118/https://cgap.nci.nih.gov/Pathways/BioCarta_Pathways" class="external-link uri">https://web.archive.org/web/20170122225118/https://cgap.nci.nih.gov/Pathways/BioCarta_Pathways</a>. This is an archive of BioCarta’s successor website cgap.nci.nih.gov which is also retired from internet. The snapshot is taken on 2017-01-22. Member genes as well as the coordinates on the image are parsed from the HTML code. The script is also shipped in the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"script"</span>, <span class="st">"process.R"</span>, package <span class="op">=</span> <span class="st">"BioCartaImage"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/private/var/folders/g3/f2y6rp510nxf3t5sj6h902bc0000gr/T/RtmpGlRYGs/temp_libpath173ae274dad83/BioCartaImage/script/process.R"</span></span></code></pre>
<p>The total pathways in the BioCarta database:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/BioCartaImage" class="external-link">BioCartaImage</a></span><span class="op">)</span></span>
<span><span class="va">ap</span> <span class="op">=</span> <span class="fu"><a href="../reference/all_pathways.html">all_pathways</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ap</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 314</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ap</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "h_RELAPathway"    "h_no1Pathway"     "h_gsPathway"      "h_CSKPathway"    </span></span>
<span><span class="co">## [5] "h_pkcPathway"     "h_srcRPTPPathway"</span></span></code></pre>
<p>A single pathway can be obtained by providing the pathway ID:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_pathway.html">get_pathway</a></span><span class="op">(</span><span class="st">"h_RELAPathway"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">## A BioCarta pathway:</span></span>
<span><span class="co">##   ID: h_RELAPathway</span></span>
<span><span class="co">##   Name: Acetylation and Deacetylation of RelA in The Nucleus</span></span>
<span><span class="co">##   35 nodes, 16 genes</span></span></code></pre>
<p>The pathway object <code>p</code> is actually a very simply list which contains coordinates of member genes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 6</span></span>
<span><span class="co">##  $ id        : chr "h_RELAPathway"</span></span>
<span><span class="co">##  $ name      : chr "Acetylation and Deacetylation of RelA in The Nucleus"</span></span>
<span><span class="co">##  $ genes     : chr [1:35] "rela" "rela" "rela" "rela" ...</span></span>
<span><span class="co">##  $ shape     : chr [1:35] "poly" "poly" "poly" "poly" ...</span></span>
<span><span class="co">##  $ coords    :List of 35</span></span>
<span><span class="co">##   ..$ : num [1:42] 235 418 235 409 237 402 241 397 246 394 ...</span></span>
<span><span class="co">##   ..$ : num [1:42] 342 304 351 303 358 305 364 308 366 314 ...</span></span>
<span><span class="co">##   ..$ : num [1:42] 342 230 351 229 358 231 364 234 366 240 ...</span></span>
<span><span class="co">##   ..$ : num [1:42] 333 115 342 114 349 116 355 119 357 125 ...</span></span>
<span><span class="co">##   ..$ : num [1:42] 82 235 91 234 98 236 104 239 106 245 ...</span></span>
<span><span class="co">##   ..$ : num [1:42] 214 126 223 125 230 127 236 130 238 136 ...</span></span>
<span><span class="co">##   ..$ : num [1:40] 205 418 205 409 208 402 212 397 217 395 ...</span></span>
<span><span class="co">##   ..$ : num [1:40] 362 336 353 335 346 332 341 328 339 322 ...</span></span>
<span><span class="co">##   ..$ : num [1:40] 361 261 352 260 345 257 340 253 338 247 ...</span></span>
<span><span class="co">##   ..$ : num [1:40] 351 145 342 144 335 141 330 137 328 131 ...</span></span>
<span><span class="co">##   ..$ : num [1:40] 100 266 91 265 84 262 79 258 77 252 ...</span></span>
<span><span class="co">##   ..$ : num [1:40] 235 157 226 156 219 153 214 149 212 143 ...</span></span>
<span><span class="co">##   ..$ : num [1:34] 61 92 66 93 70 95 73 99 74 103 ...</span></span>
<span><span class="co">##   ..$ : num [1:34] 85 123 72 121 65 124 62 124 61 122 ...</span></span>
<span><span class="co">##   ..$ : num [1:18] 54 111 55 112 55 124 54 125 19 125 ...</span></span>
<span><span class="co">##   ..$ : num [1:40] 227 296 218 295 211 292 206 288 204 282 ...</span></span>
<span><span class="co">##   ..$ : num [1:10] 41 143 41 123 81 123 81 143 41 143</span></span>
<span><span class="co">##   ..$ : num [1:42] 210 265 219 264 226 266 232 269 234 275 ...</span></span>
<span><span class="co">##   ..$ : num [1:38] 55 202 71 205 75 202 80 201 84 202 ...</span></span>
<span><span class="co">##   ..$ : num [1:68] 50 57 48 51 47 48 48 46 50 47 ...</span></span>
<span><span class="co">##   ..$ : num [1:24] 65 19 70 21 72 23 71 25 63 44 ...</span></span>
<span><span class="co">##   ..$ : num [1:34] 426 355 436 356 445 358 450 362 453 366 ...</span></span>
<span><span class="co">##   ..$ : num [1:34] 391 133 401 134 410 136 415 140 418 144 ...</span></span>
<span><span class="co">##   ..$ : num [1:8] 182 153 178 156 174 149 182 153</span></span>
<span><span class="co">##   ..$ : num [1:12] 177 161 182 158 184 163 183 166 181 168 ...</span></span>
<span><span class="co">##   ..$ : num [1:10] 168 163 162 161 168 155 171 156 168 163</span></span>
<span><span class="co">##   ..$ : num [1:34] 164 156 158 162 164 164 164 168 150 170 ...</span></span>
<span><span class="co">##   ..$ : num [1:12] 170 170 171 165 173 159 175 160 179 167 ...</span></span>
<span><span class="co">##   ..$ : num [1:10] 173 156 162 151 159 146 170 148 173 156</span></span>
<span><span class="co">##   ..$ : num [1:18] 238 362 241 365 241 375 238 378 207 378 ...</span></span>
<span><span class="co">##   ..$ : num [1:34] 561 356 571 357 580 359 585 363 588 367 ...</span></span>
<span><span class="co">##   ..$ : num [1:30] 324 354 346 353 350 354 354 357 346 363 ...</span></span>
<span><span class="co">##   ..$ : num [1:34] 49 247 59 248 68 250 73 254 76 258 ...</span></span>
<span><span class="co">##   ..$ : num [1:34] 396 249 406 250 415 252 420 256 423 260 ...</span></span>
<span><span class="co">##   ..$ : num [1:18] 248 378 251 381 251 391 248 394 217 394 ...</span></span>
<span><span class="co">##  $ image_file: chr "h_relaPathway.gif"</span></span>
<span><span class="co">##  - attr(*, "class")= chr "biocarta_pathway"</span></span></code></pre>
<p>Similar as many other packages which contain BioCarta gene sets, the member genes of a pathway can be obtained by <code><a href="../reference/genes_in_pathway.html">genes_in_pathway()</a></code>. You can provide the pathway ID or the pathway object. The EntreZ ID is used as the gene ID type.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/genes_in_pathway.html">genes_in_pathway</a></span><span class="op">(</span><span class="st">"h_RELAPathway"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "1387" "8772" "8841" "4792" "1147" "3551" "8517" "4790" "2033" "5970"</span></span>
<span><span class="co">## [11] "8737" "7124" "7132" "7133" "8717" "7189"</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/genes_in_pathway.html">genes_in_pathway</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "1387" "8772" "8841" "4792" "1147" "3551" "8517" "4790" "2033" "5970"</span></span>
<span><span class="co">## [11] "8737" "7124" "7132" "7133" "8717" "7189"</span></span></code></pre>
<p>Next, let’s move to the main functionality of this package: customizing the pathway.</p>
<p>First, as many other <strong>grid</strong> plotting functions, <code><a href="../reference/pathwayGrob.html">grid.pathway()</a></code> draws a pathway (where the pathway image is a <code>raster</code> object internally).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pathwayGrob.html">grid.pathway</a></span><span class="op">(</span><span class="st">"h_RELAPathway"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCartaImage_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>You can specify the location and how the image is aligned to the anchor point.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pathwayGrob.html">grid.pathway</a></span><span class="op">(</span><span class="st">"h_RELAPathway"</span>, x <span class="op">=</span> <span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">0.2</span>, just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"bottom"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCartaImage_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>You can also first create a viewport, then draw the pathway inside it.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.7</span>, height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">grid.rect</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># to show the area of the viewport</span></span>
<span><span class="fu"><a href="../reference/pathwayGrob.html">grid.pathway</a></span><span class="op">(</span><span class="st">"h_RELAPathway"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCartaImage_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>As the aspect ratio of the image is fixed, you can either set <code>width</code> or <code>height</code>. If both are set, the size of the image is internally adjusted to let the image maximally fill the plotting region.</p>
<p>One of the main use of the pathway image is to highlight genes of interest. The simple use is to set the <code>color</code> argument which is a named vector where gene EntreZ ID are names. When the colors are set, the genes are highlighted with dashed colored borders.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pathwayGrob.html">grid.pathway</a></span><span class="op">(</span><span class="st">"h_RELAPathway"</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1387"</span> <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCartaImage_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>As normally BioCarta pathway images are colorful, it is quite difficult to find a proper color to be distinguished from other genes. There is a more flexible way in the package which allows to add self-defined graphics besides the genes.</p>
<p>To edit the pathway image, we create the pathway grob first (“grob” is short for “graphic object”).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grob</span> <span class="op">=</span> <span class="fu"><a href="../reference/pathwayGrob.html">pathwayGrob</a></span><span class="op">(</span><span class="st">"h_RELAPathway"</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>grob</code> basically contains a viewport and a raster image. Later we can add graphics for single genes to it.</p>
<p>Graphics for single genes are added by the function <code><a href="../reference/mark_gene.html">mark_gene()</a></code>. You need to provide the pathway grob, the gene EntreZ ID and a self-defined graphics function. As you can imagine, the input of the function is the coordinate of the polygon of the gene in forms of two vectors: the x-coordinates and the y-coordinates.</p>
<p>There are two ways to implement the graphics function. First, the function directly returns a grob object. Later this grob is inserted to the global pathway grob.</p>
<p>There is a helper function <code><a href="../reference/pos_by_polygon.html">pos_by_polygon()</a></code> which returns the position of a certain side of the polygon.</p>
<p>In the following code, we add a yellow point to the left side of gene “1387” (CBP in the image).</p>
<p>The graphics are drawn in the pathway image viewport which already has a coordinate system associated. the “xscale” and “yscale” correspond to the numbers of pixels horizontally and vertically. So <code>unit(1, "native")</code> means 1 pixel in the original image.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">grob2</span> <span class="op">=</span> <span class="fu"><a href="../reference/mark_gene.html">mark_gene</a></span><span class="op">(</span><span class="va">grob</span>, <span class="st">"1387"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pos</span> <span class="op">=</span> <span class="fu"><a href="../reference/pos_by_polygon.html">pos_by_polygon</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, where <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.points.html" class="external-link">pointsGrob</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, default.units <span class="op">=</span> <span class="st">"native"</span>,</span>
<span>        pch <span class="op">=</span> <span class="fl">16</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html" class="external-link">grid.draw</a></span><span class="op">(</span><span class="va">grob2</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCartaImage_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>If you have complicated graphics, you can consider to use <code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree()</a></code> and <code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList()</a></code> to combine them.</p>
<p>If you are not familiar with <code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree()</a></code> and <code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList()</a></code> or <code>*Grob()</code> functions. You can directly use the grid plotting functions such as <code><a href="https://rdrr.io/r/grid/grid.points.html" class="external-link">grid.points()</a></code> or <code><a href="https://rdrr.io/r/grid/grid.lines.html" class="external-link">grid.lines()</a></code>. In this case, you have to set <code>capture</code> to <code>TRUE</code>, then the graphics will be captured as grobs internally.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">grob3</span> <span class="op">=</span> <span class="fu"><a href="../reference/mark_gene.html">mark_gene</a></span><span class="op">(</span><span class="va">grob</span>, <span class="st">"1387"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pos</span> <span class="op">=</span> <span class="fu"><a href="../reference/pos_by_polygon.html">pos_by_polygon</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, where <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.points.html" class="external-link">grid.points</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, default.units <span class="op">=</span> <span class="st">"native"</span>,</span>
<span>        pch <span class="op">=</span> <span class="fl">16</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span>, capture <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html" class="external-link">grid.draw</a></span><span class="op">(</span><span class="va">grob3</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCartaImage_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>With this functionality, you can implement complicated graphics to associate to a gene. In the following example, we create a viewport and put it on the left of the gene.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">grob4</span> <span class="op">=</span> <span class="fu"><a href="../reference/mark_gene.html">mark_gene</a></span><span class="op">(</span><span class="va">grob</span>, <span class="st">"1387"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pos</span> <span class="op">=</span> <span class="fu"><a href="../reference/pos_by_polygon.html">pos_by_polygon</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">10</span>, y <span class="op">=</span> <span class="va">pos</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>        width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span>, height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span>, </span>
<span>        default.units <span class="op">=</span> <span class="st">"native"</span>, just <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">grid.rect</a></span><span class="op">(</span>gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid.text</a></span><span class="op">(</span><span class="st">"add whatever\nyou want here"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span>, capture <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html" class="external-link">grid.draw</a></span><span class="op">(</span><span class="va">grob4</span><span class="op">)</span></span></code></pre></div>
<p><img src="BioCartaImage_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.0 (2022-04-22)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Big Sur/Monterey 10.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib</span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] BioCartaImage_0.99.0 knitr_1.43          </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] Rcpp_1.0.11       magrittr_2.0.3    R6_2.5.1          ragg_1.2.5       </span></span>
<span><span class="co">##  [5] rlang_1.1.1       fastmap_1.1.1     highr_0.10        stringr_1.5.0    </span></span>
<span><span class="co">##  [9] tools_4.2.0       xfun_0.39         cli_3.6.1         jquerylib_0.1.4  </span></span>
<span><span class="co">## [13] systemfonts_1.0.4 htmltools_0.5.5   yaml_2.3.7        digest_0.6.33    </span></span>
<span><span class="co">## [17] rprojroot_2.0.3   lifecycle_1.0.3   pkgdown_2.0.7     textshaping_0.3.6</span></span>
<span><span class="co">## [21] purrr_1.0.1       sass_0.4.7        vctrs_0.6.3       fs_1.6.2         </span></span>
<span><span class="co">## [25] curl_5.0.1        memoise_2.0.1     glue_1.6.2        cachem_1.0.8     </span></span>
<span><span class="co">## [29] evaluate_0.21     rmarkdown_2.23    stringi_1.7.12    compiler_4.2.0   </span></span>
<span><span class="co">## [33] bslib_0.5.0       magick_2.7.4      desc_1.4.2        jsonlite_1.8.7</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
